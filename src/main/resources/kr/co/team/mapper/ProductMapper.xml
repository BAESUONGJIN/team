<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
 PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybats-3-mapper.dtd">
<mapper namespace="kr.co.team.mapper.ProductMapper">

	<select id="getdae" resultType="kr.co.team.vo.DaeVO">
		select * from dae where
		dcode=#{param1}
	</select>

	<select id="getbunho" resultType="Integer">
		select
		ifnull(substring(max(pcode),4,3),"0") from product where pcode like
		concat(#{param1},'%')

	</select>

	<select id="pro_write" resultType="kr.co.team.vo.DaeVO">
		select * from dae order by
		dcode asc
	</select>

	<insert id="pro_write_ok" parameterType="kr.co.team.vo.ProductVO">
		insert into
		product(dcode,baesong,pimg,pcode,title,size,color,stock,cimg,price,halin,writeday)
		values(#{dcode},#{baesong},#{pimg},#{pcode},#{title},#{size},#{color},#{stock},#{cimg},#{price},#{halin},now())
	</insert>

	<select id="pro_list" resultType="kr.co.team.vo.ProductVO">  <!-- 최신순 -->
		select * from product where dcode=#{param1} order by pcode desc limit
		#{param2},#{param3}
	</select>

	<select id="getchong" resultType="Integer"> <!--총 페이지수 구하기 -->
		select ceil(count(*)/${param1}) from product where dcode=#{param2};
	</select>

	<select id="pro_content" resultType="kr.co.team.vo.ProductVO">
		select * from product where pcode=#{param1}
	</select>

	<!-- 상품평 리스트 -->
	<select id="pro_review_list" resultType="kr.co.team.vo.ReviewVO">
		select * from review where pcode=#{param1} order by id desc limit 10
	</select>


	<!-- 상품평 작성 -->
	<insert id="pro_review_write_ok" parameterType="kr.co.team.vo.ReviewVO">
		insert into review(userid,pcode,content,writeday)
		values(#{userid},#{pcode},#{content},now())
	</insert>
	
	<!-- 상품문의 리스트 -->
	<select id="pro_inquiry_list" resultType="kr.co.team.vo.InquiryVO">
	select i.*,a.cid,a.content as content1 from inquiry as i, answer as a 
	where pcode=#{param1} and i.id = a.cid order by id desc limit 10
	</select>
	
	<insert id="pro_inquiry_write_ok" parameterType="kr.co.team.vo.InquiryVO">
	insert into inquiry(userid,title,pcode,content,writeday)
	values(#{userid},#{title},#{pcode},#{content},now())
	</insert>
	
</mapper>